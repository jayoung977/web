<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>동적 폼 실습</title>
    <!-- axios 실습 위한 axios CDN -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  </head>
  <body>
    <h1>동적 폼 실습</h1>
    <hr />
    <h2>실습1. axios get 회원가입</h2>
    <form name="login1">
      <!-- label for === input id -->
      <label for="name">이름</label>
      <!-- name: 은 서버가 확인하는 키값 -->
      <input type="text" id="name" name="name" />
      <br />
      <br />
      <fieldset>
        <legend>성별</legend>
        <!-- radio버튼 하나만 선택하기 위해서는 name을 동일하게 해야함 name은 키값 value는 값-->
        <input type="radio" name="gender" id="male" value="male" checked />
        <label for="male">남성</label>
        <input type="radio" name="gender" id="female" value="female" />
        <label for="female">여성</label>
      </fieldset>
      <br />
      <fieldset>
        <legend>생년 월일</legend>
        <!-- input type date도 됨 -->
        <select id="year" name="year">
          <%for (let i =0; i < 50; i++){%>
          <option value="<%= 2010-i%>"><%= 2010-i%></option>
          <%}%>
        </select>
        <label for="year">년</label>
        <select id="month" name="month">
          <%for (let i =1; i < 13; i++){%>
          <option value="<%= i%>"><%= i%></option>
          <%}%>
        </select>
        <label for="month">월</label>
        <select id="day" name="day">
          <%for (let i =1; i < 31; i++){%>
          <option value="<%= i%>"><%= i%></option>
          <%}%>
        </select>
        <label for="day">일</label>
      </fieldset>
      <br />
      <fieldset>
        <legend>관심사</legend>
        <input
          type="checkbox"
          name="hobby"
          id="travel"
          value="travel"
          checked
        />
        <label for="travel">여행</label>
        <input type="checkbox" name="hobby" id="fashion" value="fashion" />
        <label for="fashion">패션</label>
        <input type="checkbox" name="hobby" id="food" value="food" />
        <label for="food">음식</label>
      </fieldset>
      <br />
      <button type="button" onclick="axiosGet();">회원가입</button>
    </form>
    <br />
    <div class="result1"></div>
    <hr />

    <h2>실습2. axios post 로그인</h2>
    <p class="explain">
      (참고) app.js에 저장한 아이디는 banana이고, 비밀번호는 4321입니다.
      아이디와 비밀번호가 일치할 때와 불일치할 때 어떻게 다른지 확인해보세요!!
    </p>
    <form name="login2">
      <label for="id">아이디</label>
      <input type="text" id="id" name="id" />
      <label for="pw">비밀번호</label>
      <input type="password" id="pw" name="pw" />
      <button type="button" onclick="axiosPost();">로그인</button>
      <br />
      <br />
      <div class="result2"></div>
    </form>

    <script>
      document.querySelector(".explain").style.color = "gray";
      document.querySelector(".explain").style.fontSize = "12px";

      //실습1. axios get 회원가입
      const resultBox1 = document.querySelector(".result1");

      async function axiosGet() {
        const form = document.forms["login1"];
        const formInfo = { name: form.name.value };

        try {
          const response = await axios({
            url: "/axios",
            method: "GET",
            params: formInfo, //  axios GET 요청은 params 키값으로
          });
          if (response.data.name) {
            resultBox1.textContent = ` ${response.data.name}님 환영합니다! 가입이
      완료되었습니다.🎉`;
            resultBox1.style.color = "blue";
          } else {
            resultBox1.textContent = `이름은 필수 값입니다!`;
            resultBox1.style.color = "gray";
          }
        } catch (error) {
          console.log("Error!", error);
        }
      }

      //실습2. axios post 로그인
      const resultBox2 = document.querySelector(".result2");

      async function axiosPost() {
        const form = document.forms["login2"];
        const formInfo = { id: form.id.value, pw: form.pw.value };

        try {
          const response = await axios({
            url: "/axios",
            method: "POST",
            data: formInfo, //axios POST요청은 data 키값에 담아야함(<-> GET은 params)
          });

          resultBox2.textContent = response.data.msg;
          resultBox2.style.color = response.data.color;
        } catch (error) {
          console.log("Error!", error);
        }
      }
    </script>
  </body>
</html>
